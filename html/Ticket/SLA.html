<& /Elements/Header, Title => $title &>
<& /Elements/Tabs &>

<&| /Widgets/TitleBox, title => loc('Summary') &>
<& /Elements/SLA/ShowReportSummary, Summary => $summary &>
</&>

<%ARGS>
$id => undef
</%ARGS>
<%INIT>

unless (
    $session{'CurrentUser'}->PrincipalObj->HasRight(
        Object => $RT::System, Right => 'SeeSLAReports',
    )
) {
    Abort("You're not allowed to see SLA reports.");
}

my $ticket = LoadTicket($id);
unless ($ticket->CurrentUserHasRight('ShowTicket')) {
    Abort("No permission to view ticket");
}
$id = $ARGS{'id'} = $ticket->id;

my $title = loc("SLA performance on ticket #[_1]", $id);

use RT::Extension::SLA;
my $report = RT::Extension::SLA->TicketReport( $ticket );
my $summary = $report->Summary;
</%INIT>
